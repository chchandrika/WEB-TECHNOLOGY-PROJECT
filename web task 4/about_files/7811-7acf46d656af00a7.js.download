"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7811],{2662:function(e,t,s){s.d(t,{Z:function(){return a}});var l=s(85893);s(67294);var i=s(4819),r=s(93181);function a(e){let{title:t,onSubmit:s,onCancel:a,isLoading:n}=e;return(0,l.jsxs)("div",{className:"flex justify-between p-6 items-center w-full bg-background z-50",children:[(0,l.jsx)("div",{children:(0,l.jsx)(i.z,{onClick:a,variant:"outline",children:"Cancel"})}),(0,l.jsx)("div",{children:t}),(0,l.jsx)("div",{children:(0,l.jsx)(i.z,{onClick:s,variant:"accent",disabled:n,children:n?(0,l.jsx)(r.frZ,{className:"animate-spin"}):"Done"})})]})}},8369:function(e,t,s){s.d(t,{Z:function(){return el}});var l=s(85893),i=s(67294),r=s(81768),a=s(94991),n=s(52091),o=s(16841),d=s(97998),c=s(67394),m=s(70406),u=s(85945),x=s(86010),p=s(4819),h=s(8978),f=s(73047);let v=e=>{let{initialData:t,promptId:s,className:v,iconSize:j=16,onLikedChange:g,noBorder:w,likedClassName:N,unlikedClassName:y}=e,{isLoggedIn:b}=(0,a.kP)(),k=(0,a.d$)(),C=(0,u.NL)(),{data:z}=(0,d.C)({promptId:s,options:{initialData:t}}),P=!!(null==z?void 0:z.isLiked),I=(null==z?void 0:z.likesCount)||0,_=(0,i.useCallback)((e,t)=>{C.setQueryData([...d.E,s],{isLiked:e,likesCount:t})},[s,C]),D=(0,i.useCallback)(()=>{_(P,I)},[I,P,_]),R=(0,c.o)({promptId:s,options:{onError:()=>{D(),k("Could not like","error")}}}),M=(0,m.o)({promptId:s,options:{onError:()=>{D(),k("Could not remove like","error")}}}),{isLiked:S}=z||{},{setIsLogInModalOpen:A}=(0,o.l9)(),Z=async e=>{if(e.stopPropagation(),e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),!b)return A(!0);_(!P,I+(P?-1:1)),S?(M.mutate(),null==g||g(!1)):(R.mutate(),null==g||g(!0))};return(0,l.jsx)(r.pn,{children:(0,l.jsxs)(r.u,{children:[(0,l.jsx)(r.aJ,{asChild:!0,children:(0,l.jsxs)(p.z,{onClick:Z,variant:"ghost",className:(0,x.Z)(S?N:y,!S&&w&&"",v),children:[(0,l.jsx)("span",{className:"mr-1",children:S?(0,l.jsx)(n.$0H,{size:j,className:"text-[#F91880]"}):(0,l.jsx)(n.BgW,{size:j})}),I>0&&(0,l.jsx)("span",{className:(0,f.cn)("ml-1",S?"text-[#F91880]":""),children:(0,h.u)(I)})]})}),(0,l.jsx)(r._v,{children:"Like"})]})})};var j=s(4886),g=s(11163);let w=e=>{let{promptId:t,disabled:s}=e,{push:n}=(0,g.useRouter)(),{isLoggedIn:d}=(0,a.kP)(),{setIsLogInModalOpen:c}=(0,o.l9)(),m=(0,i.useCallback)(()=>{if(!d){c(!0);return}n("/create?promptId="+t+"&stylesTab=styles")},[d,n,t,c]);return(0,l.jsx)(r.pn,{children:(0,l.jsxs)(r.u,{children:[(0,l.jsx)(r.aJ,{asChild:!0,children:(0,l.jsx)(p.z,{variant:"ghost",onClick:m,disabled:s,children:(0,l.jsx)(j.Z,{name:"recreate",size:20})})}),(0,l.jsx)(r._v,{children:"Reuse"})]})})};var N=s(9598),y=s(7696),b=s(24092),k=s(48228);async function C(e,t){let s=await fetch("".concat((0,b.f)(),"/prompt/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isArchived:t})}),l=await s.json();return l[0]}let z=e=>{let{promptId:t,isArchived:s,options:l}=e;return(0,k.D)(()=>C(t,s),{...l,mutationKey:["togglePromptVisibility",t,s]})};var P=s(36492);let I=async e=>{let t=await fetch("/api/prompt/".concat(e,"/isArchived"),{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}});return t.json()},_=["isArchived"],D=e=>{let{promptId:t,options:s}=e;return(0,P.a)([..._,t],()=>I(t),{...s,staleTime:1/0})};var R=s(70154);let M=e=>{let{promptId:t,isCurrentlyArchived:s}=e,a=(0,N.d)(),n=(0,u.NL)(),{data:o}=D({promptId:t,options:{initialData:{isArchived:s}}}),d=!(null==o?void 0:o.isArchived),{mutate:c,isLoading:m}=z({isArchived:d,promptId:t,options:{onSuccess:async()=>{d?a("Post archived!"):a("Post unarchived!"),n.setQueryData([..._,t],{isArchived:d}),n.setQueriesData({predicate:e=>{let{queryKey:t}=e;return t[0]===R.Db[0]}},e=>{if(!e)return e;let s=e.pages.map(e=>({...e,feedItems:e.feedItems.filter(e=>e.post.data.id!==t)}));return{...e,pages:s}})},onError:()=>{a("Something went wrong","error")}}}),x=(0,i.useCallback)(()=>{c()},[c]);return(0,l.jsx)(r.pn,{children:(0,l.jsxs)(r.u,{children:[(0,l.jsx)(r.aJ,{asChild:!0,children:(0,l.jsx)(p.z,{variant:"ghost",size:"sm",onClick:x,disabled:m,children:(null==o?void 0:o.isArchived)?(0,l.jsx)(y.z2M,{size:20}):(0,l.jsx)(y.tlU,{size:20})})}),(0,l.jsx)(r._v,{children:(null==o?void 0:o.isArchived)?"Unarchive":"Archive"})]})})};var S=s(50933),A=s(97349);async function Z(e,t){let s=await fetch("".concat((0,b.f)(),"/prompt/").concat(e,"/toggleIsRestricted"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isRestricted:t})});return s.json()}let T=e=>{let{promptId:t,isRestricted:s,options:l}=e;return(0,k.D)(()=>Z(t,s),{...l,mutationKey:["toggleIsRestricted",t,s]})},U=e=>{let{withTooltip:t,onClick:s,promptId:a,initialData:n,...d}=e,c=(0,o.Wg)(),[m,x]=(0,i.useState)(!1),h=(0,u.NL)(),f=(0,N.d)(),{data:v}=(0,S.G)({promptId:a,options:{initialData:n}}),g=(0,i.useCallback)(e=>{h.setQueryData([...S.I,a],{isRestricted:e})},[a,h]),w=!(null==v?void 0:v.isRestricted),{mutate:y}=T({isRestricted:w,promptId:a,options:{onSuccess:async()=>{w?f("Prompt details hidden!"):f("Prompt details published!"),h.invalidateQueries({predicate:e=>{let{queryKey:t}=e,s=t[0]===A.$j[0]&&t.includes(a);return s}})},onError:()=>{g(!w),f("Something went wrong","error")}}}),b="lockUnlocked";b=(null==v?void 0:v.isRestricted)?m?"lockUnlocked":"lockLocked":m?"lockLocked":"lockUnlocked";let k=(0,i.useCallback)(()=>{g(w),y(),null==s||s()},[w,y,g,s]);return(0,l.jsx)(r.pn,{children:(0,l.jsxs)(r.u,{children:[(0,l.jsx)(r.aJ,{asChild:!0,children:(0,l.jsx)(p.z,{size:"sm",variant:"ghost",...d,onClick:k,onMouseEnter:()=>{x(!0),c(a)},onMouseLeave:()=>{x(!1),c(null)},children:(0,l.jsx)(j.Z,{size:20,name:b})})}),(0,l.jsx)(r._v,{children:(null==v?void 0:v.isRestricted)?"Show prompt":"Hide prompt"})]})})};var E=s(66),O=s(3778),L=s(78633),F=s(22579),X=s(18318),Y=s(77182),q=s(20084),W=s(16605);let H=e=>{let{prompt:t,isRestricted:s,onCopyComplete:r}=e,{copy:n}=(0,a.FU)(),{toast:d}=(0,Y.pm)(),{isLoggedIn:c}=(0,a.kP)(),{setIsLogInModalOpen:m}=(0,o.l9)(),u=(0,i.useCallback)(()=>{if(!c){m(!0);return}s?d({description:"This prompt is restricted and cannot be copied."}):(n(t),d({description:"Prompt copied to clipboard!",variant:"success"}),null==r||r(),(0,q.L9)(W._.promptCopied,{promptId:t}))},[t,s,r,n,d,c,m]);return(0,l.jsxs)(p.z,{onClick:u,variant:"ghost",size:"sm",className:"w-full text-left justify-start",children:[(0,l.jsx)(X.On2,{size:16,className:"mr-2"}),"Copy prompt"]})};async function J(e,t){let s=await fetch("".concat((0,b.f)(),"/prompt/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPrivate:t})}),l=await s.json();return l[0]}let Q=e=>{let{promptId:t,isPrivate:s,options:l}=e;return(0,k.D)(()=>J(t,s),{...l,mutationKey:["togglePromptPrivate",t,s]})},G=async e=>{let t=await fetch("/api/prompt/".concat(e,"/isPrivate"),{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}});return t.json()},B=["isPrivate"],V=e=>{let{promptId:t,options:s}=e;return(0,P.a)([...B,t],()=>G(t),{...s,staleTime:1/0})},$=e=>{let{isCurrentlyPrivate:t,promptId:s}=e,{toast:r}=(0,Y.pm)(),a=(0,u.NL)(),{data:n}=V({promptId:s,options:{initialData:{isPrivate:t}}}),o=!(null==n?void 0:n.isPrivate),{mutate:d}=Q({isPrivate:o,promptId:s,options:{onSuccess:async()=>{o?r({description:"Post made private!",variant:"success"}):r({description:"Post made public!",variant:"success"}),a.setQueryData([...B,s],{isPrivate:o}),a.setQueriesData({predicate:e=>{let{queryKey:t}=e;return t[0]===R.Db[0]}},e=>{if(!e)return e;let t=e.pages.map(e=>({...e,feedItems:e.feedItems.map(e=>{if(e.post.data.id===s){let t={...e,post:{...e.post,data:{...e.post.data,isPrivate:o}}};return t}return e})}));return{...e,pages:t}})},onError:()=>{r({description:"Something went wrong",variant:"destructive"})}}}),c=(0,i.useCallback)(()=>{d()},[d]),m=(null==n?void 0:n.isPrivate)?L.rCC:L.I$m,x=(null==n?void 0:n.isPrivate)?"Make public":"Make private";return(0,l.jsxs)(p.z,{variant:"ghost",size:"sm",onClick:c,className:"w-full text-left justify-start",children:[(0,l.jsx)(m,{size:16,className:"mr-2"}),x]})},K=e=>{let{meta:t,onDownloadComplete:s}=e,{toast:r}=(0,Y.pm)(),{user:n}=(0,a.kP)(),o=(0,i.useCallback)(()=>{let e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t.comfyWorkflow,null,2)),l=document.createElement("a");l.setAttribute("href",e),l.setAttribute("download","comfyWorkflow.json"),document.body.appendChild(l),l.click(),l.remove(),r({description:"ComfyWorkflow downloaded as JSON!",variant:"success"}),null==s||s()},[t,s,r]);return(null==n?void 0:n.isAdmin)?(0,l.jsxs)(p.z,{onClick:o,variant:"ghost",className:"shrink-0",children:[(0,l.jsx)(X.k$5,{className:"mr-2"}),"Download workflow"]}):null};var ee=s(43575);let et=e=>{var t;let{prompt:s}=e,{user:r}=(0,a.kP)(),o=(null==r?void 0:r.isAdmin)||!1,d=(0,a.rY)({promptUserId:(null===(t=s.user)||void 0===t?void 0:t.id)||""}),[c,m]=i.useState(!1),u=(0,F.iJ)(),x=(0,g.useRouter)(),h=async()=>{u(s.id),m(!1),x.push("/profile")};return d||o?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ee.Z,{title:"Delete Prompt?",description:"This canâ€™t be undone and it will be removed from your profile and search.",isOpen:c,setIsOpen:m,buttons:[{text:"Delete",onClick:h},{text:"Cancel",variant:"tertiary",onClick:()=>m(!1)}]}),(0,l.jsxs)(O.J2,{children:[(0,l.jsx)(O.xo,{asChild:!0,children:(0,l.jsx)(p.z,{variant:"ghost",size:"sm",className:"p-2",children:(0,l.jsx)(L.evw,{})})}),(0,l.jsxs)(O.yk,{side:"top",className:"w-auto p-2 flex flex-col gap-1",children:[s.prompt&&(0,l.jsx)(H,{prompt:s.prompt,isRestricted:s.isRestricted}),(0,l.jsx)(K,{meta:s.meta}),(0,l.jsx)($,{promptId:s.id,isCurrentlyPrivate:s.isPrivate}),(0,l.jsxs)(p.z,{variant:"ghost",size:"sm",onClick:()=>m(!0),className:"w-full text-left justify-start",children:[(0,l.jsx)(n.Xm5,{size:16,className:"mr-2"}),"Delete prompt"]})]})]})]}):null},es=e=>{var t;let{prompt:s,withTooltip:i}=e,{user:n}=(0,a.kP)(),o=(0,a.rY)({promptUserId:(null===(t=s.user)||void 0===t?void 0:t.id)||"",skipAdminCheck:!0}),d=null==n?void 0:n.isAdmin,c=o||d;return(0,l.jsx)(r.pn,{children:(0,l.jsxs)("div",{className:"w-full flex justify-evenly items-center mb-4 space-x-2",children:[(0,l.jsx)(v,{initialData:{isLiked:s.liked,likesCount:s.likeCount},withTooltip:i,promptId:s.id}),!s.isRestricted&&(0,l.jsx)(w,{promptId:s.id,withTooltip:i,disabled:!c}),c&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M,{promptId:s.id,isCurrentlyArchived:s.isArchived}),(0,l.jsx)(U,{initialData:{isRestricted:s.isRestricted},promptId:s.id})]}),!s.isPrivate&&(0,l.jsxs)("div",{className:"flex flex-row justify-center items-center gap-1 text-sm",children:[(0,l.jsx)(E.Z,{size:20,strokeWidth:3}),(0,h.u)(s.viewCount)]}),c&&(0,l.jsx)("div",{children:(0,l.jsx)(et,{prompt:s})})]})})};var el=es},69835:function(e,t,s){s.d(t,{Z:function(){return H}});var l=s(85893),i=s(67294),r=s(7696),a=s(9328),n=s(4819),o=s(94991),d=s(19042),c=s(92981),m=s(93162);let u=async e=>{try{e.startsWith("https://imagedelivery.net")||(e+=".jpeg");let t=await fetch(e,{headers:{Accept:"image/jpeg, image/png"}}),s=await t.blob();(0,m.saveAs)(s,(0,c.Mc)())}catch(l){console.log(l),window.open(e,"_blank")}},x=e=>{let{asset:t,closeDrawer:s}=e,i=e=>{e.stopPropagation(),u(t.cfUrl||t.src),s&&s()},r=(0,o.ac)("(min-width: 768px)");return r?(0,l.jsxs)(a.Xi,{onClick:i,children:[(0,l.jsx)(d.H_7,{size:16,className:"mr-2"}),"Download"]}):(0,l.jsxs)(n.z,{onClick:i,size:"lg",variant:"secondary",className:"w-full gap-3 flex justify-start px-4",children:[(0,l.jsx)(d.H_7,{size:16})," Download"]})};var p=s(61121),h=s(77182);let f=e=>{let{asset:t,closeDrawer:s}=e,{toast:i}=(0,h.pm)(),r=(0,o.ac)("(min-width: 768px)"),d=async()=>{try{await navigator.clipboard.writeText(t.src),i({description:"Image URL copied to clipboard!",variant:"success"}),s&&s()}catch(e){console.error("Failed to copy: ",e),i({description:"Failed to copy URL",variant:"destructive"})}};return r?(0,l.jsxs)(a.Xi,{onClick:d,children:[(0,l.jsx)(p.BNl,{size:16,className:"mr-2"}),"Copy image URL"]}):(0,l.jsxs)(n.z,{onClick:d,size:"lg",variant:"secondary",className:"w-full gap-3 flex justify-start px-4",children:[(0,l.jsx)(p.BNl,{size:16})," Copy image URL"]})},v=e=>{let{setShowCropModal:t,closeDrawer:s}=e,i=e=>{e.stopPropagation(),t(!0),s&&s()},r=(0,o.ac)("(min-width: 768px)");return r?(0,l.jsxs)(a.Xi,{onClick:i,children:[(0,l.jsx)(p.GZo,{size:16,className:"mr-2"}),"Crop"]}):(0,l.jsxs)(n.z,{onClick:i,size:"lg",variant:"secondary",className:"w-full gap-3 flex justify-start px-4",children:[(0,l.jsx)(p.GZo,{size:16})," Crop"]})};var j=s(13671),g=s(22579),w=s(70154);let N=e=>{let{asset:t,prompt:s,closeDrawer:i}=e,r=(0,g.N9)(),d=(0,o.ac)("(min-width: 768px)"),c=e=>{e.stopPropagation();let l=s.assets,a=null;1===l.length&&(a=setTimeout(()=>(0,w.b_)(s.id),1e4)),r(t,()=>{a&&(clearTimeout(a),a=null),(0,w.he)({id:s.id,assets:l}),i&&i()})};return d?(0,l.jsxs)(a.Xi,{onClick:c,className:"text-destructive",children:[(0,l.jsx)(j.Z,{size:16,className:"mr-2"}),"Delete"]}):(0,l.jsxs)(n.z,{onClick:c,size:"lg",variant:"secondary",className:"w-full gap-3 flex justify-start px-4 text-destructive",children:[(0,l.jsx)(j.Z,{size:16})," Delete"]})};var y=s(9598),b=s(11163);let k=e=>{let{asset:t,prompt:s,closeDrawer:i}=e,r=(0,y.d)(),d=(0,b.useRouter)(),c=(0,o.ac)("(min-width: 768px)"),m=async e=>{e.stopPropagation();let l=await fetch("/api/asset/".concat(t.id,"/isolate")).then(e=>e.json());(0,w.wf)(l),(0,w.he)({id:s.id,assets:s.assets.filter(e=>e.id!==t.id)}),r("Success"),d.asPath.includes("create")||d.push("/prompt/".concat(l.post.data.id)),i&&i()};return c?(0,l.jsxs)(a.Xi,{onClick:m,children:[(0,l.jsx)(p.Zw4,{size:16,className:"mr-2"}),"Post image separately"]}):(0,l.jsxs)(n.z,{onClick:m,size:"lg",variant:"secondary",className:"w-full gap-3 flex justify-start px-4",children:[(0,l.jsx)(p.Zw4,{size:16})," Post image separately"]})};var C=s(52091),z=s(22197),P=s(85459),I=s(16841);let _=e=>{let{asset:t,closeDrawer:s}=e,{setIsCreating:i,isCreating:r}=(0,g.RO)(),d=(0,z.Y)("upscaleAndVariation"),{setIsOpen:c}=(0,I.Tf)(),m=(0,b.useRouter)(),{mutate:u}=(0,P.X)({assetId:t.id,onSuccess:()=>i(!1)}),x=e=>{if(!d){c(!0,"upscale");return}i(!0),m.pathname.includes("create")||m.pathname.includes("feed")?m.asPath.includes("prompt")&&m.push(m.pathname):m.push("/create"),u(),window.scrollTo(0,0),e.stopPropagation(),s&&s()},p=(0,o.ac)("(min-width: 768px)");return p?(0,l.jsxs)(a.Xi,{disabled:r,onClick:x,children:[(0,l.jsx)(C.U9w,{size:16,className:"mr-2"}),"Upscale"]}):(0,l.jsxs)(n.z,{disabled:r,onClick:x,size:"lg",variant:"secondary",className:"w-full gap-3 flex justify-start px-4",children:[(0,l.jsx)(C.U9w,{size:16})," Upscale"]})};var D=s(19151),R=s(72146);let M=e=>{var t;let{asset:s,prompt:r,closeDrawer:d}=e,{setReferenceImage:m}=(0,g.YN)(),{setControlNetItems:u}=(0,g.Od)(),{setOutput:x}=(0,g.tW)(),{setCanvas:p}=(0,g.$P)(),{setReferencePercentage:h}=(0,g.No)(),{setImageCount:f}=(0,g.ZT)(),v=(0,b.useRouter)(),j=i.useMemo(()=>{var e;return(null===(e=r.provider)||void 0===e?void 0:e.name)==="Stable Diffusion XL"},[null===(t=r.provider)||void 0===t?void 0:t.name]),w=e=>{e.stopPropagation(),m(void 0);let t=r.meta;f(1);let l=(0,R.G)(t.width,t.height);x(l.output),p(l.canvas),h(100),u([{enabled:!0,id:(0,c.Mc)(),image:s.src,isControlNetOutput:!1,maskImage:void 0,model:"none",settings:{controlnet_conditioning_scale:.8,detection_resolution:512,canny_low_threshold:100,canny_high_threshold:200,mlsd_thr_v:.1,mlsd_thr_d:.1}},{enabled:!0,id:(0,c.Mc)(),image:s.src,isControlNetOutput:!1,maskImage:void 0,model:"tile",settings:{controlnet_conditioning_scale:.4,detection_resolution:512,canny_low_threshold:100,canny_high_threshold:200,mlsd_thr_v:.1,mlsd_thr_d:.1}}]),v.push("/create?promptId=".concat(r.id,"&skipRef=true&page=general&autoCreate=true&skipCN=true")),d&&d()},N=(0,o.ac)("(min-width: 768px)");return N?(0,l.jsxs)(a.Xi,{disabled:j,onClick:w,children:[(0,l.jsx)(D.Hcu,{size:16,className:"mr-2"}),"Boost details"]}):(0,l.jsxs)(n.z,{disabled:j,onClick:w,size:"lg",variant:"secondary",className:"w-full gap-3 flex justify-start px-4",children:[(0,l.jsx)(D.Hcu,{size:16})," Boost details"]})},S=e=>{var t;let{asset:s,prompt:r,closeDrawer:m}=e,{setReferenceImage:u}=(0,g.YN)(),{setControlNetItems:x}=(0,g.Od)(),{setOutput:p}=(0,g.tW)(),{setCanvas:h}=(0,g.$P)(),{setReferencePercentage:f}=(0,g.No)(),{setImageCount:v}=(0,g.ZT)(),j=(0,b.useRouter)(),w=i.useMemo(()=>{var e;return(null===(e=r.provider)||void 0===e?void 0:e.name)==="Stable Diffusion XL"},[null===(t=r.provider)||void 0===t?void 0:t.name]),N=e=>{e.stopPropagation(),u(void 0);let t=r.meta;v(1);let l=(0,R.G)(t.width,t.height);p(l.output),h(l.canvas),f(100),x([{enabled:!0,id:(0,c.Mc)(),image:s.src,isControlNetOutput:!1,maskImage:void 0,model:"tile",settings:{controlnet_conditioning_scale:.2,detection_resolution:512,canny_low_threshold:100,canny_high_threshold:200,mlsd_thr_v:.1,mlsd_thr_d:.1}}]),j.push("/create?promptId=".concat(r.id,"&skipRef=true&page=general&autoCreate=true&skipCN=true")),m&&m()},y=(0,o.ac)("(min-width: 768px)");return y?(0,l.jsxs)(a.Xi,{disabled:w,onClick:N,children:[(0,l.jsx)(d.NNQ,{size:16,className:"mr-2"}),"Magic enhancer"]}):(0,l.jsxs)(n.z,{disabled:w,onClick:N,size:"lg",variant:"secondary",className:"w-full gap-3 flex justify-start px-4",children:[(0,l.jsx)(d.NNQ,{size:16})," Magic enhancer"]})};var A=s(93181);let Z=e=>{let{asset:t,prompt:s,closeDrawer:i}=e,{applyReferenceImage:r,setReferenceImage:d}=(0,g.YN)(),c=(0,b.useRouter)(),m=(0,o.ac)("(min-width: 768px)"),u=e=>{e.stopPropagation(),d(void 0),r(t.cfUrl||t.src),c.asPath.includes("create")||c.push("/create?promptId=".concat(s.id,"&skipRef=true&page=general")),i&&i()};return m?(0,l.jsxs)(a.Xi,{onClick:u,children:[(0,l.jsx)(A.oNA,{size:16,className:"mr-2"}),"Use as reference"]}):(0,l.jsxs)(n.z,{onClick:u,size:"lg",variant:"secondary",className:"w-full gap-3 flex justify-start px-4",children:[(0,l.jsx)(A.oNA,{size:16})," Use as reference"]})};var T=s(39865),U=s(55559),E=s(2662),O=s(96120),L=s.n(O);s(96167);var F=s(25675),X=s.n(F),Y=s(73047);function q(e){let{isOpen:t,handleClose:s,onSubmit:r,image:a,aspect:n}=e,o=(0,i.useRef)(null),[d,c]=(0,i.useState)({x:10,y:10,width:80,height:80,unit:"%"}),[m,u]=(0,i.useState)(),[x,p]=(0,i.useState)(!1),h=()=>{p(!1)},f=()=>{p(!0),r(m)};return(0,l.jsxs)(U.Z,{isOpen:t,handleClose:s,children:[(0,l.jsx)(E.Z,{onCancel:s,title:"Crop Image",onSubmit:f,isLoading:x}),(0,l.jsxs)(L(),{ruleOfThirds:!0,crop:d,onChange:(e,t)=>c(t),onComplete:(e,t)=>u(t),aspect:n,className:"relative",children:[(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 ",children:(0,l.jsx)(A.frZ,{className:(0,Y.cn)("w-16 h-16 animate-spin ",!x&&"hidden")})}),(0,l.jsx)(X(),{ref:o,alt:"Crop Image",src:a,width:640,height:640,onLoad:h,className:(0,Y.cn)("w-full h-full",x&&"opacity-50")})]})]})}let W=e=>{let{index:t,asset:s,prompt:d,onUpdate:c}=e,[m,u]=i.useState(!1),[p,h]=i.useState(!1),j=(0,o.ac)("(min-width: 768px)"),g=d.assets.length>1,y=()=>h(!1);return(0,l.jsxs)("div",{className:"z-30 lg:invisible group-hover:visible absolute top-2 right-2 text-center w-fit h-fit md:flex flex-col justify-center items-center gap-1",children:[j?(0,l.jsxs)(a.h_,{children:[(0,l.jsx)(a.$F,{asChild:!0,children:(0,l.jsx)(n.z,{size:"icon",variant:"overlay",children:(0,l.jsx)(r.yjk,{size:16})})}),(0,l.jsxs)(a.AW,{align:"end",children:[g&&(0,l.jsx)(k,{asset:s,prompt:d}),(0,l.jsx)(_,{asset:s}),(0,l.jsx)(x,{asset:s}),(0,l.jsx)(v,{setShowCropModal:u}),(0,l.jsx)(f,{asset:s}),(0,l.jsx)(Z,{asset:s,prompt:d}),(0,l.jsx)(a.VD,{}),(0,l.jsx)(M,{asset:s,prompt:d}),(0,l.jsx)(S,{asset:s,prompt:d}),(0,l.jsx)(a.VD,{}),(0,l.jsx)(N,{asset:s,prompt:d})]})]}):(0,l.jsxs)(T.dy,{open:p,onOpenChange:h,children:[(0,l.jsx)(T.Qz,{asChild:!0,children:(0,l.jsx)(n.z,{size:"icon",variant:"overlay",children:(0,l.jsx)(r.yjk,{size:16})})}),(0,l.jsxs)(T.sc,{children:[(0,l.jsx)(T.OX,{className:"text-left",children:(0,l.jsx)(T.iI,{children:"Manage Asset"})}),(0,l.jsxs)("div",{className:"px-4 py-2 space-y-2 flex flex-col gap-2",children:[g&&(0,l.jsx)(k,{asset:s,prompt:d,closeDrawer:y}),(0,l.jsx)(_,{asset:s,closeDrawer:y}),(0,l.jsx)(x,{asset:s,closeDrawer:y}),(0,l.jsx)(v,{setShowCropModal:u,closeDrawer:y}),(0,l.jsx)(f,{asset:s,closeDrawer:y}),(0,l.jsx)(Z,{asset:s,prompt:d,closeDrawer:y}),(0,l.jsx)(M,{asset:s,prompt:d,closeDrawer:y}),(0,l.jsx)(S,{asset:s,prompt:d,closeDrawer:y}),(0,l.jsx)(N,{asset:s,prompt:d,closeDrawer:y})]}),(0,l.jsx)(T.ze,{className:"pt-2",children:(0,l.jsx)(T.uh,{asChild:!0,children:(0,l.jsx)(n.z,{variant:"ghost",children:"Cancel"})})})]})]}),m&&(0,l.jsx)(q,{image:s.cfUrl||s.src,isOpen:!!m,aspect:s.width/s.height,handleClose:()=>u(!1),onSubmit:async e=>{let l=await fetch("/api/prompt/".concat(d.id),{method:"PATCH",body:JSON.stringify({crop:e,assetId:s.id}),headers:{"Content-Type":"application/json"}}),i=await l.json();(0,w.he)({id:d.id,assets:d.assets.map((e,s)=>({...s===t?{...e,cfUrl:i.cfUrl}:e,promptId:d.id,color:""}))}),null==c||c({...s,cfUrl:i.cfUrl}),u(!1)}})]})};var H=W},26107:function(e,t,s){s.d(t,{_v:function(){return h},aJ:function(){return p},u:function(){return x}});var l=s(85893),i=s(67294),r=s(76530),a=s(37899),n=s(63679),o=s(88301),d=s(65820),c=s(63387);let m=i.createContext(null),u=()=>{let e=i.useContext(m);if(null==e)throw Error("Tooltip components must be wrapped in <Tooltip />");return e};function x(e){let{children:t,...s}=e,r=function(){let{initialOpen:e=!1,placement:t="top",defaultOffset:s,open:l,onOpenChange:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[d,c]=i.useState(e),m={mainAxis:5,crossAxis:0,...s},u=null!=l?l:d,x=null!=r?r:c,p=(0,a.YF)({placement:t,open:u,onOpenChange:x,whileElementsMounted:n.Me,middleware:[(0,o.cv)(m),(0,n.RR)(),(0,n.uY)()]}),h=p.context,f=(0,a.XI)(h,{move:!1,enabled:null==l,handleClose:(0,a.xp)()}),v=(0,a.KK)(h,{enabled:null==l}),j=(0,a.bQ)(h),g=(0,a.qs)(h,{role:"tooltip"}),w=(0,a.NI)([f,v,j,g]);return i.useMemo(()=>({open:u,setOpen:x,...w,...p}),[u,x,w,p])}(s);return(0,l.jsx)(m.Provider,{value:r,children:t})}let p=i.forwardRef(function(e,t){let{children:s,asChild:a=!1,...n}=e,o=u(),d=null==s?void 0:s.ref,c=i.useMemo(()=>(0,r.l)([o.reference,t,d]),[o.reference,t,d]);return a&&i.isValidElement(s)?i.cloneElement(s,o.getReferenceProps({ref:c,...n,...s.props,"data-state":o.open?"open":"closed"})):(0,l.jsx)("div",{ref:c,"data-state":o.open?"open":"closed",...o.getReferenceProps(n),children:s})}),h=i.forwardRef(function(e,t){var s,n,o,m;let x=u(),p=i.useMemo(()=>(0,r.l)([x.floating,t]),[x.floating,t]),{className:h,...f}=x.getFloatingProps(e);return(0,l.jsx)(a.ll,{children:(0,l.jsx)(d.M,{children:x.open&&(0,l.jsx)(c.E.div,{ref:p,className:h||"px-6 py-4 bg-popover text-popover-foreground font-medium rounded-lg border-border border shadow-[0_3px_10px_rgb(0,0,0,0.2)]",initial:{opacity:0,scale:1},animate:{opacity:1,scale:1,transition:{duration:.5,delay:0}},exit:{opacity:0,scale:1},style:{position:x.strategy,top:x.y&&(null==e?void 0:null===(s=e.insets)||void 0===s?void 0:s.top)?x.y+(null==e?void 0:null===(n=e.insets)||void 0===n?void 0:n.top):x.y?x.y:0,left:x.x&&(null==e?void 0:null===(o=e.insets)||void 0===o?void 0:o.left)?x.x+(null==e?void 0:null===(m=e.insets)||void 0===m?void 0:m.left):x.x?x.x:0,visibility:null==x.x?"hidden":"visible",zIndex:9999,...e.style},...f})})})})},81768:function(e,t,s){s.d(t,{_v:function(){return c},aJ:function(){return d},pn:function(){return n},u:function(){return o}});var l=s(85893),i=s(67294),r=s(96739),a=s(73047);let n=r.zt,o=r.fC,d=r.xz,c=i.forwardRef((e,t)=>{let{className:s,sideOffset:i=4,...n}=e;return(0,l.jsx)(r.VY,{ref:t,sideOffset:i,className:(0,a.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})});c.displayName=r.VY.displayName},50933:function(e,t,s){s.d(t,{G:function(){return a},I:function(){return r}});var l=s(36492);let i=async e=>{let t=await fetch("/api/prompt/".concat(e,"/isRestricted"),{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}});return t.json()},r=["isRestricted"],a=e=>{let{promptId:t,options:s}=e;return(0,l.a)([...r,t],()=>i(t),{...s,staleTime:1/0})}},37811:function(e,t,s){s.r(t),s.d(t,{__N_SSP:function(){return ey},default:function(){return eb}});var l=s(85893),i=s(55300),r=s(79627),a=s(97349),n=s(4886),o=s(91254),d=s(41695),c=s(69031),m=s(65820),u=s(2962),x=s(9008),p=s.n(x),h=s(25675),f=s.n(h),v=s(41664),j=s.n(v),g=s(11163),w=s.n(g),N=s(67294),y=s(52091),b=s(84849),k=s(95062),C=s(77378),z=s(22579);let P=e=>{let{referenceImage:t,referenceMode:s,strength:i}=e,r=function(e){if(!e)return"Normal";let t=e.controlNetModel?"ControlNet - ".concat(e.controlNetModel):"Normal";return t}(s);return(0,l.jsxs)("div",{className:"flex gap-3 text-xs w-full items-center",children:[(0,l.jsx)("div",{className:"w-[100px] h-[100px]",children:(0,l.jsx)("a",{target:"_blank",href:t,rel:"noreferrer",className:"flex w-[100px] h-[100px] rounded-lg aspect-square overflow-hidden cursor-zoom-in",children:(0,l.jsx)("img",{src:t,alt:"Reference",className:"border-transparent bg-neutral-700 object-cover w-full object-center hover:opacity-80 hover:scale-110 transform transition duration-500"})})}),(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col justify-center items-start w-full grow shrink relative gap-0",children:[(0,l.jsx)("p",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Mode"}),(0,l.jsx)("p",{className:"text-left text-[#8042E4] dark:text-purple-300 font-mono",children:r})]}),void 0!==i&&(0,l.jsxs)("div",{className:"flex flex-col justify-center items-start w-full grow shrink relative gap-0",children:[(0,l.jsx)("p",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Image strength"}),(0,l.jsxs)("p",{className:"text-left dark:text-emerald-200 text-emerald-700 font-mono",children:[i,"%"]})]})]})]})};var I=s(93181);let _=e=>{let{controlNetImage:t,controlNetModel:s,strength:i}=e;return(0,l.jsxs)("div",{className:"flex gap-3 text-xs w-full items-center",children:[(0,l.jsx)("div",{className:"w-[100px] h-[100px]",children:(0,l.jsx)("a",{target:"_blank",href:t,rel:"noreferrer",className:"flex w-[100px] h-[100px] rounded-lg aspect-square overflow-hidden cursor-zoom-in",children:(0,l.jsx)("img",{src:t,alt:"Reference",className:"border-transparent bg-neutral-700 object-cover w-full object-center hover:opacity-80 hover:scale-110 transform transition duration-500"})})}),(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col justify-center items-start w-full grow shrink relative gap-0 ",children:[(0,l.jsx)("p",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Mode"}),(0,l.jsx)("p",{className:"text-left text-[#8042E4] dark:text-purple-300 font-mono",children:s})]}),(0,l.jsxs)("div",{className:"flex flex-col justify-center items-start w-full grow shrink relative gap-0 ",children:[(0,l.jsx)("p",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Strength"}),(0,l.jsxs)("p",{className:"text-left text-[#8042E4] dark:text-purple-300 font-mono",children:[i,"%"]})]})]})]})};var D=s(42397),R=s(4819);let M=e=>{var t;let{meta:s,width:i,height:r,name:a,selectedAssetUrl:n}=e,o=N.useMemo(()=>{let e=null==n?void 0:n.split("_").pop();return e?isNaN(parseInt(e))?0:parseInt(e)-1:0},[n]),{applyReferenceImage:d}=(0,z.YN)(),c=e=>{(null==s?void 0:s.referenceImage)&&(e.stopPropagation(),d(null==s?void 0:s.referenceImage),w().push("/create"))},m=N.useMemo(()=>{if(null==s?void 0:s.engine)return(null==s?void 0:s.engine)==="stable-diffusion-v1-5"?"PhChroma2"===s.model?"PhChroma 2":"PhChroma3"===s.model?"PhChroma 3":"Stable Diffusion 1.5":"stable-diffusion-xl"===s.engine?"Stable Diffusion XL":"Stable Diffusion 2.1"},[null==s?void 0:s.model,null==s?void 0:s.engine]);return(0,l.jsxs)(l.Fragment,{children:[(null==s?void 0:s.referenceImage)&&(0,l.jsxs)(D.Zb,{children:[(0,l.jsx)(D.Ol,{children:(0,l.jsxs)(D.ll,{className:"text-sm leading-5 font-medium flex justify-between items-center",children:[(0,l.jsx)("span",{children:"Reference Image"}),(0,l.jsxs)(R.z,{onClick:c,size:"sm",variant:"secondary",className:"h-fit py-1 text-xs",children:["Reuse ",(0,l.jsx)(I.KRP,{size:16,className:"ml-1"})]})]})}),(0,l.jsx)(D.aY,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"flex flex-col gap-4",children:(0,l.jsx)("div",{className:"text-left ",children:" "})}),(0,l.jsx)(P,{referenceImage:s.referenceImage,referenceMode:{controlNetModel:s.controlNetModel},strength:s.promptStrength})]})})]}),null==s?void 0:null===(t=s.controlNetItems)||void 0===t?void 0:t.filter(e=>Boolean(e.outputImage)).map((e,t)=>{var i;let r=(null==e?void 0:null===(i=e.settings)||void 0===i?void 0:i.controlnet_conditioning_scale)||1;return(0,l.jsx)(D.Zb,{children:(0,l.jsxs)(D.aY,{className:"flex flex-col gap-4 text-xs pt-6",children:[(0,l.jsx)("div",{className:"flex flex-col gap-4",children:(0,l.jsx)("div",{className:"flex justify-between text-sm font-medium text-left ",children:(0,l.jsx)("div",{className:"leading-5 w-full",children:"ControlNet"})})}),(0,l.jsx)(_,{controlNetImage:e.outputImage,controlNetModel:e.model||s.controlNetModel,strength:100*r})]})},t)}),(0,l.jsx)(D.Zb,{children:(0,l.jsxs)(D.aY,{className:"flex flex-col gap-4 text-xs pt-6",children:[m&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Model"}),(0,l.jsx)("div",{className:"font-mono text-[#8042E4] dark:text-purple-300 line-clamp-1 text-md flex mb-1",children:(null==s?void 0:s.model)||a})]}),(null==s?void 0:s.cfg_scale)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Guidance"}),(0,l.jsx)("div",{className:"font-mono dark:text-emerald-200 text-emerald-700 text-md flex mb-1",children:null==s?void 0:s.cfg_scale})]}),i&&r&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Dimensions"}),(0,l.jsxs)("div",{className:"font-mono dark:text-emerald-200 text-emerald-700 text-md flex",children:[i," x ",r]})]}),(null==s?void 0:s.sampler)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Sampler"}),(0,l.jsx)("div",{className:"font-mono text-[#8042E4] dark:text-purple-300 line-clamp-1 text-md flex mb-1",children:null==s?void 0:s.sampler})]}),(null==s?void 0:s.seed)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Seed"}),(0,l.jsx)("div",{className:"font-mono dark:text-emerald-200 text-emerald-700 text-md flex mb-1",children:s.seed+o})]}),(null==s?void 0:s.steps)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Steps"}),(0,l.jsx)("div",{className:"font-mono dark:text-emerald-200 text-emerald-700 text-md flex mb-1",children:null==s?void 0:s.steps})]})]})})]})};var S=s(86010),A=s(61121),Z=s(78633),T=s(2777),U=s(26107);function E(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}let O=e=>{let{Icon:t,text:s,colorClassName:i,isNegative:r}=e,a=s?s.replaceAll(" ","+"):"";return(0,l.jsxs)(U.u,{placement:"top-start",children:[(0,l.jsx)(U.aJ,{children:(0,l.jsxs)("div",{className:"group flex flex-row items-center p-0 gap-2 w-full px-6 py-2 content-between lg:hover:ring-[1px] ring-inset lg:hover:ring-blue-500 hover:cursor-default",children:[(0,l.jsxs)("div",{className:"w-full flex flex-row items-center p-0 gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4",children:(0,l.jsx)(t,{className:i,size:16})}),(0,l.jsx)("div",{className:"flex flex-col items-start p-0",children:(0,l.jsx)("span",{className:(0,S.Z)("text-xs leading-5 font-normal w-full line-clamp-1",i),children:E(s)})})]}),(0,l.jsx)("div",{className:"w-fit items-center ",children:!r&&(0,l.jsx)(j(),{target:"_blank",href:"/search?q=".concat(a),className:"hover:bg-white/20 p-1 items-center justify-center rounded-md mb-0 pb-0 relative top-[2px] right-0",children:(0,l.jsx)("button",{className:"h-4 w-4",children:(0,l.jsx)("span",{className:"search-icon opacity-0 group-hover:opacity-100 items-center justify-center ",children:(0,l.jsx)(I.lnn,{name:"chevron-right",size:14})})})})})]})}),(0,l.jsx)(U._v,{children:(0,l.jsx)("div",{className:"text-[10px] max-w-[260px]",children:E(s)})})]},s)},L=e=>{let{styles:t,isNegative:s,prompt:i}=e,[r,a]=N.useState(!0),n=()=>{a(!r)},[o,c]=N.useState(!1),m=N.useMemo(()=>r?t.slice(0,6):t,[t,r]),u=N.useMemo(()=>t.length>6,[t]),x=N.useMemo(()=>{let e=0;for(let s of t)if("subject"!==s.type&&("modifier"===s.type&&e++,"theme"===s.type)){let l=s.data.modifiers;for(let i of l)"subject"!==i.type&&e++}return e},[t]),p=N.useMemo(()=>{for(let e of t)if("theme"===e.type)return!0;return!1},[t]),h=N.useMemo(()=>(0,d.X)(i)||"",[i]);return(0,l.jsxs)("div",{className:"",children:[s&&(0,l.jsxs)("button",{onClick:()=>{x>0&&n()},className:"lg:hover:ring-[1px] ring-inset lg:hover:ring-blue-500 w-full px-6 py-2 flex items-center gap-2 text-muted-foreground text-xs font-medium ".concat(0===x?"cursor-default":""),children:[x>0&&(r?(0,l.jsx)(A.mfX,{size:16}):(0,l.jsx)(A.QBW,{size:16})),0===x?"No excluded styles":"Excluded (".concat(x,")")]})||(0,l.jsx)("div",{className:"text-sm leading-5 font-medium px-6 py-1",children:0===x?"No applied styles":"Styles used (".concat(x,")")}),(0,l.jsxs)("div",{className:(0,S.Z)("flex flex-col gap-0 ".concat(s?"ml-6":""),{hidden:s&&r}),children:[m.map(e=>{switch(e.type){case"subject":return p?null:(0,l.jsx)(O,{isNegative:s,Icon:Z.OpK,colorClassName:"text-dark:text-indigo-300 text-indigo-700",text:h},"subject");case"modifier":return(0,l.jsx)(O,{Icon:I.BlD,text:e.data.name,colorClassName:"text-foreground",isNegative:s},e.data.id);case"theme":return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{onClick:()=>c(!o),className:"group flex flex-row items-center p-0 gap-2 w-full px-6 py-2 content-between lg:hover:ring-[1px] ring-inset lg:hover:ring-blue-500 hover:cursor-default",children:(0,l.jsxs)("div",{className:"w-full flex flex-row items-center p-0 gap-2",children:[(0,l.jsx)("div",{className:"-ml-5 -mr-1 w-4 h-4 item-center justify-center",children:o?(0,l.jsx)(A.QBW,{className:"text-muted-foreground cursor-pointer w-4 h-4",name:"triangleArrowDown"}):(0,l.jsx)(A.mfX,{className:"text-muted-foreground cursor-pointer w-4 h-4",name:"triangleArrowDown"})}),(0,l.jsx)("div",{className:"w-4 h-4",children:(0,l.jsx)(Z.y6p,{className:"dark:text-emerald-200 text-emerald-700",size:16})}),(0,l.jsx)("div",{className:"flex flex-col items-start p-0",children:(0,l.jsx)("span",{className:"text-xs leading-5 font-normal dark:text-emerald-200 text-emerald-700 w-full line-clamp-1",children:e.data.name})})]})},e.data.id),(0,l.jsx)("div",{className:(0,S.Z)("".concat(s?"":"ml-6"),{hidden:!o}),children:e.data.modifiers.map(e=>(0,l.jsx)(O,{isNegative:s,Icon:I.BlD,text:"subject"===e.type?h:e.name,colorClassName:"subject"===e.type?"text-dark:text-indigo-300 text-indigo-700":"dark:text-emerald-200 text-emerald-700"},e.id))})]})}}),!s&&u&&(0,l.jsxs)("button",{onClick:n,className:"hover:bg-white/10 flex gap-2 mt-1 rounded-full w-fit text-left text-xs font-medium text-muted-foreground px-2 py-1 mx-4 mb-2",children:[(0,l.jsx)(T.K9M,{className:"text-muted-foreground",size:16}),r?"View all":"View less"]})]})]})};var F=s(7297),X=s(30313);let Y=e=>{let t=[];if(!e)return t;let s=e.split(/[.,|\/;+]/);return s.forEach(e=>t.push(e.trim())),t.filter(e=>e)};var q=s(19521);function W(){let e=(0,F.Z)(["\n  transition: background-color 0.1s;\n  :hover {\n    cursor: pointer;\n    background-color: #0c8ce9;\n  }\n"]);return W=function(){return e},e}let H=(0,q.ZP)(X.xv).withConfig({componentId:"sc-5ab05dd2-0"})(W()),J=[250,160,280],Q=e=>{let{prompt:t,skeleton:s}=e,i=Y(t),[r,a]=(0,N.useState)(!0),n=(0,N.useMemo)(()=>i.length>99999,[i]),o=(0,N.useMemo)(()=>r?i.slice(0,99999):i,[r,i]);return s?(0,l.jsxs)(X.kC,{flexDirection:"column",children:[(0,l.jsx)(b.Z,{width:69,height:8}),(0,l.jsx)(X.kC,{flexDirection:"row",flexWrap:"wrap",children:J.map(e=>(0,l.jsx)(b.Z,{width:e,height:12,style:{marginRight:"8px"}},e))})]}):(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(X.kC,{flexDirection:"column",children:[(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex mb-1 mt-4",children:"Prompt"}),(0,l.jsxs)(X.xu,{children:[o.map((e,t)=>(0,l.jsxs)("span",{children:[(0,l.jsx)(j(),{href:{pathname:"/search",query:{q:e.toLowerCase()}},passHref:!0,children:(0,l.jsx)(H,{className:"text-md md:text-xl !text-foreground",children:e})}),t<o.length-1&&(0,l.jsxs)(X.xv,{className:"text-md md:text-xl text-foreground",color:"white",opacity:.8,lineHeight:"28px",children:[","," "]})]},"".concat(e,"_").concat(t))),n&&(r?(0,l.jsx)(X.W4,{onClick:()=>a(!1),alignSelf:"flex-start",style:{cursor:"pointer"},children:(0,l.jsx)(X.xv,{className:"bg-red-500 px-4 text-md md:text-xl font-bold flex ml-2 mt-1",color:"white",children:"More"})}):(0,l.jsx)(X.W4,{className:"px-4",onClick:()=>a(!0),alignSelf:"flex-start",style:{cursor:"pointer"},children:(0,l.jsx)(X.xv,{className:"bg-red-500 px-4 text-md md:text-xl font-bold flex ml-2 mt-1",color:"white",children:"Less"})}))]})]})})};var G=s(76445),B=s(94661),V=s(94991),$=s(18318),K=s(77182),ee=s(16841),et=s(20084),es=s(16605);let el=e=>{let{prompt:t,isRestricted:s,onCopyComplete:i}=e,{copy:r}=(0,V.FU)(),{toast:a}=(0,K.pm)(),{isLoggedIn:n}=(0,V.kP)(),{setIsLogInModalOpen:o}=(0,ee.l9)(),d=(0,N.useCallback)(()=>{if(!n){o(!0);return}s?a({description:"This prompt is restricted and cannot be copied."}):(r(t),a({description:"Prompt copied to clipboard!",variant:"success"}),null==i||i(),(0,et.L9)(es._.promptCopied,{promptId:t}))},[t,s,i,r,a,n,o]);return(0,l.jsxs)(R.z,{onClick:d,variant:"outline",className:"shrink-0",children:[(0,l.jsx)($.On2,{className:"mr-2"}),"Copy prompt"]})};var ei=s(42238);let er=e=>{var t,s,i,r,a,n,o,d,m;let{data:u,display:x}=e;if(!u||!x)return(0,l.jsxs)("div",{className:"flex justify-start items-center flex-grow",children:[(0,l.jsx)("div",{className:"flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-4 pr-3",children:(0,l.jsx)(b.Z,{style:{borderRadius:48},width:48,height:48})}),(0,l.jsx)("div",{className:"flex justify-start items-center flex-grow gap-3",children:(0,l.jsxs)("div",{className:"flex flex-col justify-center items-start flex-grow",children:[(0,l.jsx)(b.Z,{width:200,height:8}),(0,l.jsx)(b.Z,{width:100,height:8})]})})]});let p=(0,c.p)(new Date(u.createdAt));return(0,l.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 md:items-center w-full",children:[(0,l.jsxs)("div",{className:"flex justify-start items-center flex-grow gap-x-4",children:[(0,l.jsxs)("div",{className:"flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-4",children:[(0,l.jsxs)(ei.qE,{className:"h-12 w-12",children:[(0,l.jsx)(ei.F$,{alt:(null==u?void 0:null===(t=u.user)||void 0===t?void 0:t.username)||(null==u?void 0:null===(s=u.provider)||void 0===s?void 0:s.name),src:(null==u?void 0:u.user)&&(null==u?void 0:u.user.username)!=="prompthunt"?(null==u?void 0:null===(i=u.user)||void 0===i?void 0:i.image)||"/empty-hero.png":(null===(r=u.provider)||void 0===r?void 0:r.image)||"/empty-hero.png"}),(0,l.jsx)(ei.Q5,{children:(null==u?void 0:null===(a=u.user)||void 0===a?void 0:a.username)&&(null==u?void 0:null===(n=u.user)||void 0===n?void 0:n.username.charAt(0).toUpperCase())||(null==u?void 0:null===(o=u.provider)||void 0===o?void 0:o.name.charAt(0).toUpperCase())})]}),(null==u?void 0:u.user)&&(null==u?void 0:u.user.username)!=="prompthunt"&&(0,l.jsx)("div",{className:"ring-2 ring-background absolute flex justify-center items-center right-0 bottom-0 bg-muted bg-gradient-to-r from-[#1F1F1F]/50 to-[#363636]/50 rounded-full overflow-hidden translate-y-1/3 translate-x-1/3",children:(0,l.jsxs)(ei.qE,{className:"h-6 w-6",children:[(0,l.jsx)(ei.F$,{alt:null===(d=u.provider)||void 0===d?void 0:d.name,src:(null===(m=u.provider)||void 0===m?void 0:m.image)||"/empty-hero.png"}),(0,l.jsx)(ei.Q5,{children:"P"})]})})]}),(0,l.jsx)("div",{className:"flex justify-start items-center flex-grow gap-3",children:(0,l.jsxs)("div",{className:"flex flex-col gap-0.5 justify-center items-start flex-grow relative",children:[(0,l.jsx)("p",{className:(0,S.Z)("text-muted-foreground text-xs leading-4 font-normal overflow-x-auto",(null==u?void 0:u.user)&&(null==u?void 0:u.user.username)!=="prompthunt"&&"order-1"),children:(null==u?void 0:u.user)&&(null==u?void 0:u.user.username)!=="prompthunt"&&(0,l.jsx)("span",{className:"font-semibold gap-1",children:(0,l.jsx)(G.$,{meta:u.meta,provider:u.provider||void 0})})}),(0,l.jsxs)("div",{className:"flex gap-x-2 items-center",children:[(0,l.jsx)("label",{className:"self-stretch flex-grow-0 flex-shrink-0 text-base font-medium text-left text-foreground",children:(null==u?void 0:u.user)&&(null==u?void 0:u.user.username)!=="prompthunt"?(0,l.jsx)(j(),{href:"/user/".concat(null==u?void 0:u.user.username),children:null==u?void 0:u.user.username}):u.provider.name}),(null==u?void 0:u.user)&&(null==u?void 0:u.user.username)!=="prompthunt"&&(0,l.jsx)(B.Z,{subscriptionPlan:null==u?void 0:u.user.subscriptionPlan}),(0,l.jsx)("label",{className:"text-sm font-normal text-muted-foreground",children:p})]})]})})]}),(0,l.jsx)(el,{prompt:u.prompt||"",isRestricted:u.isRestricted,onCopyComplete:()=>console.log("Prompt copied!")})]})};var ea=s(8369),en=s(96486),eo=s.n(en),ed=s(69835),ec=s(48233),em=s(97435),eu=s(50207),ex=s(10615);s(12755);var ep=s(41576),eh=s(36492);async function ef(e,t,s,l,i,r){let a=await fetch(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"public",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,i=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,a="/api/user/".concat(e,"/prompts"),n="object"==typeof r&&Object.keys(r).length>0?Object.keys(r).map(e=>"exclude".concat(e.charAt(0).toUpperCase()+e.slice(1),"=true")).join("&"):"",o="page=".concat(s,"&limit=").concat(l,"&filter=").concat(t);return(i&&(o+="&orderBy=".concat(i)),n)?"".concat(a,"?").concat(o,"&").concat(n):"".concat(a,"?").concat(o)}(e,t,s,l,i,r),{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}});return a.json()}let ev=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"public",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,l=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;return(0,eh.a)(["promptsV2",e,t,s],()=>Promise.all(Array.from({length:s}).map((s,r)=>ef(e,t,r+1,10,l,i))).then(e=>({prompts:e.flatMap(e=>e.prompts)})),{...r,staleTime:3e5})};function ej(e){let{userId:t}=e,{data:s,isLoading:i,isError:r,error:a}=ev(t),n=N.useMemo(()=>s?eo().sampleSize(s.prompts,9):[],[s]);return i?(0,l.jsx)("div",{children:(0,l.jsx)("div",{className:"grid grid-cols-3 gap-0 relative h-fit animate-pulse",children:Array.from({length:3}).map((e,t)=>(0,l.jsx)("div",{className:"rounded-none aspect-square w-full bg-primary/10 ring-inset ring-1 ring-card"},t))})}):r?(0,l.jsxs)("div",{className:"text-center text-xs text-foreground/50",children:["There was an error fetching more posts: ",a.message]}):null==s||null==t?null:(0,l.jsx)("div",{className:"grid grid-cols-3 gap-0 relative h-fit",children:n.map(e=>(0,l.jsx)("div",{children:(0,l.jsx)(ep.Z,{width:200,data:e,squareCrop:!0,disableDataOverlay:!0})},e.id))})}var eg=s(73047);let ew=e=>{var t,s,x,h,v,w,b,z,P,I,_,A,T,U,E,O,F,X,Y,q,W,H,J,G,B,$;let{isModal:K,promptId:et}=e,{isLoggedIn:es}=(0,V.kP)(),el=(0,g.useRouter)(),ei=(0,V.Wd)("prompt"),eo=(0,ec.d)(),{showNsfw:ep,setShowNsfw:eh}=(0,ee.nf)(),ef=et||ei,{prompt:ev,isLoading:ew}=(0,a.R4)(ef,{staleTime:1/0,onError:()=>{el.push("/404")},retry:!1}),ey=(0,V.rY)({promptUserId:null===(t=ev.user)||void 0===t?void 0:t.id}),[eb,ek]=(0,N.useState)(!1),eC=(0,V.Wd)("selectedAsset"),[ez,eP]=(0,N.useState)(0),eI=(0,N.useMemo)(()=>{var e,t;return null===(e=ev.theme)||void 0===e?void 0:null===(t=e.meta)||void 0===t?void 0:t.pixelArt},[null===(s=ev.theme)||void 0===s?void 0:s.meta]);(0,N.useEffect)(()=>{var e;(null===(e=ev.assets)||void 0===e?void 0:e.length)&&ev.assets[ez]&&el.replace({pathname:el.pathname,query:{...el.query,selectedAsset:ev.assets[ez].id}},void 0,{shallow:!0})},[ez]);let e_=(0,N.useMemo)(()=>{var e;return!!ev&&null!==(e=ev.assets)&&void 0!==e&&!!e.length&&ev.assets.length>1},[ev]);(0,N.useEffect)(()=>{(0,em._V)(ev.id,ev.comments)},[ev]),(0,N.useEffect)(()=>{var e,t,s,l;ek(!((null===(e=null===(t=ev.meta)||void 0===t?void 0:t.valueOf())||void 0===e?void 0:null===(s=e.modifiers)||void 0===s?void 0:s.length)>0));let i=null===(l=ev.assets)||void 0===l?void 0:l.findIndex(e=>e.id===eC);-1!==i&&void 0!=i&&eP(i)},[eC,ev.assets,ev.meta]);let eD=()=>{ez<ev.assets.length-1?eP(ez+1):eP(0)},eR=()=>{ez>0?eP(ez-1):eP(ev.assets.length-1)},eM=(null===(x=null===(h=ev.meta)||void 0===h?void 0:h.valueOf())||void 0===x?void 0:null===(v=x.modifiers)||void 0===v?void 0:v.length)>0,eS=(null==ev?void 0:ev.meta)?(0,d.X)(ev):"",eA=null===(w=ev.user)||void 0===w?void 0:w.username,eZ=(0,N.useMemo)(()=>ev&&ev.prompt?(0,o.M)(ev):[],[ev]),eT=(0,N.useMemo)(()=>{if(!ev||!ev.prompt)return[];let e=(0,en.get)(ev,"meta.negativeStyles",[]),t=e.filter(e=>"modifier"===e.type).map(e=>e.data),s=t.map(e=>({type:"modifier",data:e,id:e.id,enabled:"boolean"!=typeof e.enabled||e.enabled}));return s},[ev]),eU=(0,N.useCallback)(()=>{var e,t;(null===(e=ev.theme)||void 0===e?void 0:e.id)&&eo(null===(t=ev.theme)||void 0===t?void 0:t.id)},[null===(b=ev.theme)||void 0===b?void 0:b.id,eo]),eE=(0,N.useMemo)(()=>{var e,t;if(ev.assets)return(null==ev?void 0:null===(e=ev.assets)||void 0===e?void 0:e[ez])||(null==ev?void 0:null===(t=ev.assets)||void 0===t?void 0:t[0])},[ev,ez]),eO=(0,N.useMemo)(()=>{var e;if(!(null===(e=ev.reusePrompt)||void 0===e?void 0:e.prompt))return null;let t=(0,d.X)({prompt:ev.reusePrompt.prompt,meta:ev.meta});return t},[ev.meta,null==ev?void 0:null===(z=ev.reusePrompt)||void 0===z?void 0:z.prompt]),eL=(0,N.useMemo)(()=>null!=ev&&!!ev.prompt&&((0,eu.c)(ev.prompt)||ev.isNsfw),[ev.isNsfw,ev.prompt]);if(ew||!(null==ev?void 0:ev.assets))return null;let eF=e=>{(0,a.so)({id:e.promptId,assets:ev.assets.map(t=>t.id===e.id?e:t)})};return(0,l.jsxs)(k.Z,{noNavBar:K,children:[(0,l.jsx)(u.PB,{title:eA+": "+(eS||"Prompt Hunt - Your home for exploring, creating, and sharing AI art"),description:"Create, explore, and share AI art using Stable Diffusion, DALL\xb7E, and Midjourney",openGraph:{title:eA+": "+(eS||"Prompt Hunt - Your home for exploring, creating, and sharing AI art"),description:"Create, explore and share AI art using Stable Diffusion, DALL\xb7E, and Midjourney",images:ev.assets.map(e=>({url:null!==(B=e.cfUrl)&&void 0!==B?B:e.src,type:"image/png",secureUrl:null!==($=e.cfUrl)&&void 0!==$?$:e.src,width:e.width,height:e.height,alt:eS})),type:"article"},twitter:{cardType:"summary_large_image"}}),(0,l.jsxs)(p(),{children:[(0,l.jsx)("meta",{name:"twitter:image",content:"/api/image/".concat(ef)}),(0,l.jsx)("meta",{name:"twitter:card",content:"summary_large_image"})]}),(0,l.jsxs)("div",{className:"flex flex-col w-fit items m-auto pb-10 lg:pb-24 lg:min-w-[1024px]",children:[(0,l.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,l.jsx)(er,{data:ev,display:["flex"]})}),(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row justify-center lg:space-x-10 bg-red-500/0",children:[(0,l.jsx)("div",{className:"bg-red-500/0 w-fit flex flex-col",children:(0,l.jsx)("div",{className:"w-fit flex flex-column gap-y-10 lg:gap-y-6",children:(0,l.jsx)("div",{className:"w-full m-auto ",children:ev&&ev?(0,l.jsxs)("div",{className:"flex flex-col gap-y-6 lg:gap-y-10 relative",children:[(0,l.jsx)("div",{className:"w-full relative justify-center items-center",children:(0,l.jsx)("div",{className:"flex object-contain max-w-3xl w-fit m-auto group relative",children:(0,l.jsx)("div",{className:(0,eg.cn)("items-center md:-mx-0 overflow-visible","-mx-4"),children:eE&&(0,l.jsxs)("div",{className:(0,S.Z)("flex max-w-3xl w-fit md:rounded-lg overflow-hidden relative items-center justify-center",eE.width<eE.height&&"max-w-[50vh]"),children:[(0,l.jsx)("div",{className:"aspect-w-1 relative aspect-h-1 !w-fit max-w-full",children:(0,l.jsxs)("div",{className:"group relative !w-fit",children:[eL&&(0,l.jsx)("div",{className:"absolute top-4 left-4 z-[100] flex gap-4",children:(0,l.jsxs)("button",{onClick:()=>eh(!ep),className:"text-xs p-2 bg-red-400 rounded-full flex items-center justify-center gap-1",children:["NSFW ",ep?(0,l.jsx)(Z.rCC,{}):(0,l.jsx)(Z.I$m,{})]})}),ey&&(0,l.jsx)(ed.Z,{onUpdate:eF,asset:eE,prompt:ev,index:ez}),(0,l.jsx)("div",{children:(0,l.jsx)(ex.lr,{className:"bg-black/10 aspect-w-1 aspect-h-1 object-contain",showStatus:!1,showThumbs:!1,infiniteLoop:!1,verticalSwipe:"natural",autoPlay:!1,preventMovementUntilSwipeScrollTolerance:!0,swipeScrollTolerance:50,swipeable:!0,showArrows:!1,emulateTouch:!0,showIndicators:!!e_,selectedItem:ez,onChange:e=>eP(e),width:"100%",children:ev.assets.map(e=>(0,l.jsx)("div",{className:"flex aspect-w-1 aspect-h-1 md:max-h-[80vh]",children:(0,l.jsx)(f(),{unoptimized:!0,src:e.cfUrl||e.src,alt:ev.prompt||"",className:(0,S.Z)("object-contain",{"blur-2xl":eL&&!ep}),width:e.width,height:e.height,quality:100,blurDataURL:"data:image/svg+xml;base64,".concat((0,r.K)(e.width,e.height)),style:{imageRendering:eI?"pixelated":"auto"}})},e.id))})})]})}),e_&&(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"invisible lg:group-hover:visible z-10 absolute px-6 flex w-full h-fit self-center items-center justify-between",children:[(0,l.jsx)("button",{onClick:eR,className:"w-10 h-10 rounded-full outline-none bg-white text-black items-center hover:scale-125 transform transition-transform duration-300",children:(0,l.jsx)(y.bUI,{size:16,className:"ml-2.5"})}),(0,l.jsx)("button",{onClick:eD,className:"w-10 h-10 rounded-full outline-none bg-white text-black items-center hover:scale-125 transform transition-transform duration-300",children:(0,l.jsx)(y.Dli,{size:16,className:"ml-3"})})]})})]})})})}),e_&&(0,l.jsx)("div",{className:"flex justify-center gap-3 flex-wrap",children:ev.assets.map((e,t)=>(0,l.jsx)("div",{className:"relative ".concat(t===ez?"border-2 border-white":""," w-16 h-16 overflow-hidden rounded-lg lg:hover:opacity-80 lg:hover:scale-110 transition-transform"),children:(0,l.jsx)("img",{alt:ev.prompt?ev.prompt+t:"",src:e.cfUrl||e.src,className:"w-full h-full cursor-pointer object-cover ".concat(eL?"blur-2xl":""),onClick:()=>{eP(t)}})},(e.cfUrl||e.src)+t))}),ev.isRestricted&&(0,l.jsxs)("div",{className:" flex flex-col justify-center items-center gap-y-4",children:[(0,l.jsxs)("div",{className:"max-w-3xl flex justify-center items-center text-muted-foreground font-semibold rounded-lg gap-x-2 bg-muted py-2.5 px-4 w-full",children:[(0,l.jsx)(n.Z,{name:"lockLocked",size:18}),"Prompt hidden"]}),(0,l.jsxs)("span",{className:"text-muted-foreground text-sm font-medium text-center",children:[null===(P=ev.user)||void 0===P?void 0:P.username," has hidden all details about this creation"]})]}),(0,l.jsx)("div",{className:"w-full flex justify-center",children:(0,l.jsx)("div",{className:"w-full max-w-lg flex items-center gap-x-4",children:(0,l.jsx)(ea.Z,{prompt:ev,withTooltip:!0})})}),(0,l.jsxs)("div",{className:"w-full m-auto max-w-xl flex flex-col gap-y-10 mb-4 lg:mb-0 justify-center items-center",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-y-2 w-full text-left justify-start",children:[eM&&!ev.isRestricted&&ev.prompt&&(0,l.jsx)("h4",{className:"text-xl mb-0",children:eS}),(0,l.jsx)(m.M,{children:eb&&!ev.isRestricted&&ev.prompt&&(0,l.jsx)(Q,{prompt:ev.prompt})}),eM&&!ev.isRestricted&&(0,l.jsx)("div",{children:(0,l.jsx)(R.z,{variant:"link",onClick:()=>ek(!eb),className:"px-0 h-fit",children:eb?"Hide prompt":"View prompt"})}),(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex mb-1",children:(0,c.p)(new Date(ev.createdAt))})]}),(null==ev?void 0:ev.reusePrompt)&&(null==ev?void 0:null===(I=ev.reusePrompt)||void 0===I?void 0:I.id)&&!ev.isRestricted&&(0,l.jsx)("div",{className:"flex w-full",children:(0,l.jsx)(D.Zb,{className:"w-full",children:(0,l.jsx)(D.aY,{className:"pt-6",children:(0,l.jsxs)("div",{className:"flex justify-start items-center gap-4",children:[(0,l.jsx)(j(),{target:"_blank",href:"/prompt/".concat(null==ev?void 0:ev.reusePrompt.id),children:(0,l.jsx)("div",{className:"flex w-[100px] h-[100px] rounded-lg aspect-square overflow-hidden cursor-zoom-in",children:(0,l.jsx)("img",{src:(null==ev?void 0:null===(_=ev.reusePrompt)||void 0===_?void 0:null===(A=_.assets)||void 0===A?void 0:A[0].cfUrl)||(null==ev?void 0:null===(T=ev.reusePrompt)||void 0===T?void 0:null===(U=T.assets)||void 0===U?void 0:U[0].url)||"",alt:"Creation",className:"border-transparent bg-neutral-700 object-cover w-full h-full object-center hover:opacity-80 hover:scale-110 transform transition duration-500"})})}),(0,l.jsxs)("div",{className:"w-fit flex flex-col justify-start items-start relative",children:[(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest mb-1",children:"Original Creation"}),(0,l.jsx)("div",{className:"flex flex-col justify-start items-start",children:(0,l.jsx)("div",{className:"flex justify-start items-start gap-2",children:(0,l.jsxs)(j(),{href:"/prompt/".concat(null==ev?void 0:ev.reusePrompt.id),children:[(0,l.jsx)("p",{className:"text-sm text-left text-foreground/80 line-clamp-2 mb-1",children:eO})," "]})})}),(0,l.jsxs)(j(),{href:"/user/".concat(ev.reusePrompt.user.username),className:"text-muted-foreground text-xs leading-5 font-normal lg:hover:underline",children:["by ",(0,l.jsxs)("span",{children:["@",ev.reusePrompt.user.username]})]})]})]})})})}),(0,l.jsx)(i.F,{parentId:ev.id,parentUserId:null===(E=ev.user)||void 0===E?void 0:E.id,type:"prompt"})]})]}):(0,l.jsx)(eN,{})})})}),(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex flex-col w-full lg:w-80 gap-2 bg-red-500/0",children:[(0,l.jsxs)(D.Zb,{children:[(0,l.jsx)(D.Ol,{children:(0,l.jsxs)(D.ll,{className:"text-sm leading-5 font-medium",children:["More by"," ",(0,l.jsx)(j(),{href:"/user/".concat(null===(O=ev.user)||void 0===O?void 0:O.username),passHref:!0,className:"underline",children:null===(F=ev.user)||void 0===F?void 0:F.username})]})}),(0,l.jsxs)(D.aY,{children:[" ",(null===(X=ev.user)||void 0===X?void 0:X.id)&&(0,l.jsx)(ej,{userId:null===(Y=ev.user)||void 0===Y?void 0:Y.id})]})]}),!ev.isRestricted&&(0,l.jsxs)(l.Fragment,{children:[(null==ev?void 0:ev.theme)&&(null==ev?void 0:ev.theme.id)&&!ev.isRestricted&&(0,l.jsx)(D.Zb,{children:(0,l.jsx)(D.aY,{className:"pt-6",children:(0,l.jsx)("div",{className:"flex flex-col gap-4",children:(0,l.jsxs)("div",{className:"flex justify-start items-center self-stretch gap-4",children:[(0,l.jsx)(j(),{href:"/theme/".concat(null==ev?void 0:ev.theme.id),className:"w-fit",children:(0,l.jsx)("div",{className:"overflow-clip border-transparent h-16 w-16 flex-none rounded-lg bg-neutral-700 object-cover object-center aspect-square",children:(0,l.jsx)(f(),{unoptimized:!0,alt:"",width:100,height:100,src:(null==ev?void 0:ev.theme.image)||"",className:""})})}),(0,l.jsxs)("div",{className:"flex flex-col justify-start items-start grow shrink relative",children:[(0,l.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest mb-1",children:"TEMPLATE USED"}),(0,l.jsx)("div",{className:"flex flex-col justify-start items-start grow shrink",children:(0,l.jsx)("div",{className:"flex justify-start items-start grow shrink relative gap-2",children:(0,l.jsx)(j(),{href:"/theme/".concat(null==ev?void 0:ev.theme.id),children:(0,l.jsx)("p",{className:"grow shrink text-sm text-left line-clamp-1",children:ev.theme.name})})})})]}),(0,l.jsx)(R.z,{size:"sm",variant:"accent",onClick:eU,children:"Try"})]})})})}),(0,l.jsx)(D.Zb,{children:(0,l.jsxs)(D.aY,{className:"py-4 px-0",children:[eZ&&!ev.isRestricted&&ev.prompt?(0,l.jsx)(L,{styles:eZ,prompt:ev}):null,eT&&!ev.isRestricted&&ev.prompt?(0,l.jsx)(L,{isNegative:!0,styles:eT,prompt:ev}):null]})}),!ev.isRestricted&&(null===(q=ev.assets)||void 0===q?void 0:q[0])&&(0,l.jsx)(M,{id:ev.id,meta:ev.meta,width:ev.assets[0].width,height:ev.assets[0].height,name:null==ev?void 0:null===(W=ev.provider)||void 0===W?void 0:W.name,selectedAssetUrl:null===(H=ev.assets[ez])||void 0===H?void 0:H.src})]})]})})]})]}),(0,l.jsx)("div",{className:"flex flex-col gap-y-6",children:(0,l.jsx)("div",{className:"flex flex-col gap-y-6 lg:gap-y-10 mb-6",children:(0,l.jsx)("p",{className:"text-[10px] lg:text-2xl font-medium text-left lg:text-center uppercase lg:normal-case text-muted-foreground tracking-wider lg:tracking-normal",children:"More prompts"})})}),es?(0,l.jsx)(C.Z,{themeId:null===(J=ev.theme)||void 0===J?void 0:J.id,query:"",excludePrompt:ev.id}):(0,l.jsx)("div",{className:"-mb-96 md:-mb-20",children:(0,l.jsx)(C.Z,{themeId:null===(G=ev.theme)||void 0===G?void 0:G.id,query:"",excludePrompt:ev.id,disableFetchMore:!0})})]})},eN=()=>(0,l.jsxs)(X.rj,{gridTemplateColumns:["1fr"],gridGap:[6,null,9],mb:"48px",children:[(0,l.jsx)(X.xu,{height:[350,450,750],children:(0,l.jsx)(b.Z,{height:"100%",style:{borderRadius:16}})}),(0,l.jsx)(X.kC,{flexDirection:"column",justifyContent:"space-between",children:(0,l.jsx)(X.kC,{flexDirection:"column",children:(0,l.jsx)(Q,{prompt:"",skeleton:!0})})})]});var ey=!0,eb=ew},72146:function(e,t,s){s.d(t,{G:function(){return l}});let l=(e,t)=>{let s="square",l="standard";return e>t?s="wide":e<t&&(s="tall"),(e>768||t>768||768===e&&768===t)&&(l="large"),{canvas:s,output:l}}},91254:function(e,t,s){s.d(t,{M:function(){return r}});var l=s(96486),i=s(41695);let r=e=>{var t;let s=[],r=(0,i.X)(e),a=(0,l.cloneDeep)((0,l.get)(e,"meta.modifiers",[])),n="string"==typeof e.themeId,o=(0,l.cloneDeep)((0,l.get)(e,"theme.modifiers",null)),d=null===(t=null==o?void 0:o.find(e=>"theme"===e.type))||void 0===t?void 0:t.data,c=null==d?void 0:d.modifiers;c&&(null==o||o.push(...c));let m=r?e.prompt.indexOf(r):0,u=a.map(t=>e.prompt.indexOf(t.name)),x=0;for(let p=0;p<u.length;p++)if(m<u[p]){x=p;break}for(let h of(a.splice(x,0,{id:"subject",name:r||"",type:"subject",enabled:!0,categories:[],strength:0,verified:!0}),a))if(h.type){if("modifier"===h.type){if(n&&o){let f=o.find(e=>e.id===h.id);f?e.themeId&&!s.find(e=>"theme"===e.type)&&s.push({id:e.themeId,type:"theme",data:e.theme,enabled:!0}):s.push({id:h.id,type:"modifier",data:h,enabled:!0})}else s.push({id:h.id,type:"modifier",data:h,enabled:!0})}else"subject"===h.type&&s.push({id:"subject",type:"subject",data:"subject",enabled:!!h.enabled,weight:h.weight||"100%"})}else s.push({id:h.id,type:"modifier",data:h,enabled:!0});return s}}}]);
//# sourceMappingURL=7811-7acf46d656af00a7.js.map